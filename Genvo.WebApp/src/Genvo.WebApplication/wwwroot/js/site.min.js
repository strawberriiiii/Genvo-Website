function addExampleData(){$.when(loadExampleHostTree(),loadExampleGuestTree()).done(function(n,t){hostTreeFile=ParseTreeData(n[0]);guestTreeFile=ParseTreeData(t[0]);document.getElementById("dz-host-text").innerHTML="<strong>Example data loaded<\/strong>";document.getElementById("dz-guest-text").innerHTML="<strong>Example data loaded<\/strong>";$("#senddatatoviz").removeClass("disabled");$("input[name=twoFileLabelOption]:checked").parent().removeClass("active");const i=$("input[name=twoFileLabelOption]:radio[value=postfix]");i.prop("checked",!0);i.parent().addClass("active");console.log("successfully fetched example data")})}function loadExampleHostTree(){return $.ajax({url:"./data/ExampleHostTree1",type:"POST"})}function loadExampleGuestTree(){return $.ajax({url:"./data/ExampleGuestTree1",type:"POST"})}function DataParser(n){this.data=this.ParseNewickToJSON(n)}function ParseTreeData(n,t){const i=new DataParser(n,t);return i.data}function parseNhxLabel(n,t,i){switch(i){case"S=":n.prime.species=t;break;case"NAME=":n.prime.name=t}}function parsePrimeLabel(n,t,i){switch(i){case"S=":n.prime.species=t;break;case"NAME=":n.prime.name=t;break;case"ID=":n.prime.id=t}}function handleHostFile(n){n.stopPropagation();n.preventDefault();var t=getDropedFile(n);document.getElementById("dz-host-text").innerHTML="<strong>"+escape(t.name)+"<\/strong>";readSelectedFile(t,"host")}function handleGuestFile(n){n.stopPropagation();n.preventDefault();var t=getDropedFile(n);document.getElementById("dz-guest-text").innerHTML="<strong>"+escape(t.name)+"<\/strong>";readSelectedFile(t,"guest")}function getDropedFile(n){var t=n.dataTransfer.files;return t[0]}function readSelectedFile(n,t){var i=new FileReader;i.onload=function(n){if(n.target.readyState===2){if(n.target.error){alert("Error while reading file");return}t==="host"?hostTreeFile=ParseTreeData(n.target.result):t==="guest"?guestTreeFile=ParseTreeData(n.target.result):console.log("error 1: drop zone ID error");guestTreeFile!==undefined&&hostTreeFile!==undefined&&$("#senddatatoviz").removeClass("disabled")}};i.readAsText(n)}function handleDragOver(n){n.stopPropagation();n.preventDefault();n.dataTransfer.dropEffect="copy"}function senddata(){if(guestTreeFile===undefined||hostTreeFile===undefined){window.alert("Host and / or guest tree not uploaded");return}const n={LabelFormat:$("input[name=twoFileLabelOption]:checked").val(),GeneTree:guestTreeFile,SpeciesTree:hostTreeFile};packdatalocal(n,"_GSTree");window.location.href="visualization"}function packdatalocal(n,t){n=JSON.stringify(n);n=btoa(n);localStorage.setItem(t,n)}var guestTreeFile,hostTreeFile,dropZoneHost,dropZoneGuest,sendbutton,exampledatabutton;DataParser.prototype.ParseNewickToJSON=function(n){var r=[],t={},u=!1,f="",i;const e=n.split(/\s*(;|\(|\)|,|:|\[|\])\s*/);for(let n=0;n<e.length;n++){const o=e[n],s={};if(u&&o!=="]"){f+=o;continue}switch(o){case"(":t.children=[s];r.push(t);t=s;t.tag={};break;case",":r[r.length-1].children.push(s);t=s;t.tag={};break;case")":t=r.pop();break;case":":break;case"[":u=!0;break;case"]":t.tag=this.parseTreeTag(f);u=!1;f="";break;default:i=e[n-1];i===")"||i==="("||i===","?t.name=o:i===":"&&(t.length=parseFloat(o))}}return t};DataParser.prototype.parseTreeTag=function(n){var r=n.split(/\s*(\${2}NHX|\&{2}PRIME|S=|ID=|NAME=)\s*/),t,i={prime:{},nhx:{},common:""};for(let n=0;n<r.length;n++){const u=r[n];switch(u){case"$$NHX":t="nhx";continue;case"&&PRIME":t="prime";continue}const f=r[n-1];t==="prime"?parsePrimeLabel(i,u,f):t==="nhx"?parseNhxLabel(i,u,f):i.common+=u}return i};window.File&&window.FileReader&&window.FileList&&window.Blob||alert("The File APIs are not fully supported in this browser. Use the latest Chrome browser");dropZoneHost=document.getElementById("drop_zone_host");dropZoneHost.addEventListener("dragover",handleDragOver,!1);dropZoneHost.addEventListener("drop",handleHostFile,!1);dropZoneHost.addEventListener("click",handleDragOver,!1);dropZoneGuest=document.getElementById("drop_zone_guest");dropZoneGuest.addEventListener("dragover",handleDragOver,!1);dropZoneGuest.addEventListener("drop",handleGuestFile,!1);sendbutton=document.getElementById("senddatatoviz");sendbutton.addEventListener("click",senddata,!1);exampledatabutton=document.getElementById("button_exampledata");exampledatabutton.addEventListener("click",addExampleData,!1);