function addExampleData(){$.when(loadExampleHostTree(),loadExampleGuestTree()).done(function(n,t){hostTreeFile=ParseTreeData(n[0],!0);guestTreeFile=ParseTreeData(t[0],!0);document.getElementById("dz-host-text").innerHTML="<strong>Example data loaded<\/strong>";document.getElementById("dz-guest-text").innerHTML="<strong>Example data loaded<\/strong>";$("#senddatatoviz").removeClass("disabled");console.log("successfully fetched example data")})}function loadExampleHostTree(){return $.ajax({url:"./data/ExampleHostTree1",type:"POST"})}function loadExampleGuestTree(){return $.ajax({url:"./data/ExampleGuestTree1",type:"POST"})}function ParseTreeData(n,t){if((t===undefined||t===null)&&(t=!1),t)return ParseNewickToJSON(n);var i=$('input[name="twoFileFormatOption"]:checked').val();switch(i){case"newick":n=ParseNewickToJSON(n);break;case"nhx":n=ParseNhxToGenvoTree(n);break;case"notung":n=ParseNotungToGenvoTree(n)}return n}function ParseNotungToJSON(){console.log("Convert from Notung")}function ParseNhxToJSON(){console.log("convert from Nhx")}function ParseNewickToJSON(n){for(var e,i,r,u=[],t={},o=n.split(/\s*(;|\(|\)|,|:)\s*/),f=0;f<o.length;f++){e=o[f];i={};switch(e){case"(":t.children=[i];u.push(t);t=i;break;case",":u[u.length-1].children.push(i);t=i;break;case")":t=u.pop();break;case":":break;default:r=o[f-1];r===")"||r==="("||r===","?t.name=e:r===":"&&(t.length=parseFloat(e))}}return t}function handleHostFile(n){n.stopPropagation();n.preventDefault();var t=getDropedFile(n);document.getElementById("dz-host-text").innerHTML="<strong>"+escape(t.name)+"<\/strong>";readSelectedFile(t,"host")}function handleGuestFile(n){n.stopPropagation();n.preventDefault();var t=getDropedFile(n);document.getElementById("dz-guest-text").innerHTML="<strong>"+escape(t.name)+"<\/strong>";readSelectedFile(t,"guest")}function getDropedFile(n){var t=n.dataTransfer.files;return t[0]}function readSelectedFile(n,t){var i=new FileReader;i.onload=function(n){if(n.target.readyState===2){if(n.target.error){alert("Error while reading file");return}t==="host"?hostTreeFile=ParseTreeData(n.target.result):t==="guest"?guestTreeFile=ParseTreeData(n.target.result):console.log("error 1: drop zone ID error");guestTreeFile!==undefined&&hostTreeFile!==undefined&&$("#senddatatoviz").removeClass("disabled")}};i.readAsText(n)}function handleDragOver(n){n.stopPropagation();n.preventDefault();n.dataTransfer.dropEffect="copy"}function senddata(){if(guestTreeFile===undefined||hostTreeFile===undefined){window.alert("Gene and / or species tree not uploaded");return}var n={GeneTree:guestTreeFile,SpeciesTree:hostTreeFile};packdatalocal(n,"_GSTree");window.location.href="visualization"}function packdatalocal(n,t){n=JSON.stringify(n);n=btoa(n);localStorage.setItem(t,n)}var guestTreeFile,hostTreeFile,dropZoneHost,dropZoneGuest,sendbutton,exampledatabutton;window.File&&window.FileReader&&window.FileList&&window.Blob||alert("The File APIs are not fully supported in this browser. Use the latest Chrome browser");dropZoneHost=document.getElementById("drop_zone_host");dropZoneHost.addEventListener("dragover",handleDragOver,!1);dropZoneHost.addEventListener("drop",handleHostFile,!1);dropZoneHost.addEventListener("click",handleDragOver,!1);dropZoneGuest=document.getElementById("drop_zone_guest");dropZoneGuest.addEventListener("dragover",handleDragOver,!1);dropZoneGuest.addEventListener("drop",handleGuestFile,!1);sendbutton=document.getElementById("senddatatoviz");sendbutton.addEventListener("click",senddata,!1);exampledatabutton=document.getElementById("button_exampledata");exampledatabutton.addEventListener("click",addExampleData,!1);